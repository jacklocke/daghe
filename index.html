<!doctype html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1">
   <title>Startpage</title>

   <script
   src="https://code.jquery.com/jquery-3.6.1.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>

   <style>
         /* loader */
         #loading {
            position: fixed;
            display: block;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            text-align: center;
            opacity: 1;
            background-color: #fff;
            z-index: 99;
         }

         #loading-image {
            position: absolute;
            left: 50%;
            margin-left: -50px;
            top: 50%;
            margin-top: -50px;
            z-index: 100;
            height: 80px;
         }
   </style>
   <link rel="stylesheet" href="css/index.css">
   <link rel="stylesheet" href="css/typewrite.css">
   <link rel="stylesheet" href="css/periodic.css">
   
</head>
<body>
 
         <div class="background-wrap">
         <div class="container">
            <h2>Daghe!</h2>
            <div id="welcome" class="typewriter">
               <h3 id="welc_msg">/!\</h3>
            </div>

            <!--help-->   
            <button type="button" class="collapsible"><img class="icon" src="assets/question.png"/></button>
            <div class="collapsible_content">
               <h3 class="note_title"><a>Notes</a></h3>
               <ul>
                  <li>b: or brave: for brave search</li>
                  <li>g: or google: for google search</li>
                  <li>d: or duck: for duckduckgo search</li>
                  <li>a: or amazon: for amazon search</li>
                  <li>w: or wiki: for wikipedia search</li>
                  <li>y: or youtube: for youtube search</li>
               </ul>

                        <!--github corner-->
                        <a href="https://github.com/jacklocke/daghe" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#64CEAA; color:#fff; position: absolute; top: 0; border: 0; left: 0; transform: scale(-1, 1);" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
            </div>

            <!-- side GIF-->
            <img id="sideGIF" src="assets/side.gif" />

            <!--clock-->
            <div id="clock" onload="currentTime()"></div>

            <!-- links -->
            <div class="services">

               <div class="form__group">
                  <input type="input" class="form__field" placeholder="Name" name="autofill" id='autofill' required />
                  <label for="autofill" class="form__label">Run...</label>
                  <img class="icon" src="assets/clear.png" onclick="$('#autofill').val('');$('#autofill').keyup();lastActions();" />
               </div>

               <div id="item_container" class="items">

                  <br>

                  <ul class = "list-group" id = "newList">
                     
                     <!-- AREA FOR LINK CREATION
                        <li class="list-group-item">
                           <a href="#linkedin_website">
                                 <div class="p_element yellow" >
                                    <div class="p_element-inner"  data-description="cixo">
                                       <div class="title">Li</div>
                                       <div class="description">LinkedIn</div>
                                    </div>
                              </div>
                           </a><span class="tooltiptext">data description 1</span>
                        </li>
                        -->

                  </ul>
               </div>
            </div>

         </div></div><!--container and wrap-->


         <!-- API footer -->
         <div id="footer"></div>
         <p id="footer_content"></p>


         <script>
            $(document).ready(function(){
               $("#autofill").on("keyup", function() {

                  var value = $(this).val().toLowerCase();

                  if(checkIfFunction()) {
                     value = '';
                  }

                  $("#newList li").filter(function() {

                     var _texts = $(this).find('.title').text();
                     _texts+=" "+$(this).find('.description').text();
                     _texts+=" "+$(this).find('.tooltiptext').text(); // for searching also in tooltip
                     _texts = _texts.toLowerCase();
                     //console.log( _texts);

                     var _vis = _texts.indexOf(value) > -1;
                     $(this).toggle(_vis)
                     
                     if(_vis) {
                        if ($(this).hasClass('hided')){
                           $(this).removeClass('hided');   
                        }
                     } else {
                        if ($(this).hasClass('selected')){
                           $(this).removeClass('selected');
                           checkBase();

                        }
                        $(this).addClass('hided');
                     }

                  });

                  

               });

               $("#autofill").focus();


            });


            let json_path = "data/data.json";
            $.ajax({
               url: json_path,
               type: "GET",
               statusCode: {
                  404: function() {
                     // if not found
                     console.log("missing /data/data.json!");
                     alert("missing /data/data.json , please use /data/data-dist.json to create your own")

                  }
               },
               success:function(json) {
                  //code here
                  loadData(json_path);
               }
            });

            function loadData(_path) {
               /* load data */
               fetch(_path)
                  .then((resp) => resp.json())
                     .then((json) => {
                        for (let x = 0; x < json.length; x++) {
                           //console.log(json[x]['title']);

                           let _element = "";
                           _element+= "<li class=\"list-group-item\">";
                           _element+= "   <a href=\"" + json[x]["url"] + "\">";
                           _element+= "         <div class=\"p_element " + json[x]["color"] + "\">";
                           _element+= "            <div class=\"p_element-inner\">";
                           _element+= "               <div class=\"title\">" + json[x]["title"] + "</div>";
                           _element+= "                <div class=\"description\">" + json[x]["desc"] +  "</div>";
                           _element+= "            </div>";
                           _element+= "      </div>";
                           _element+= "   </a><span class=\"tooltiptext\">" + json[x]["tooltip"] + "</span>";
                           _element+= "</li>";

                           $("#newList").append(_element);
                        }

                        $(".services li").mouseover(function() {
                        
                           if(checkIfFunction()) {
                              return;
                           }

                           $(".services li").removeClass("selected");
                           $(this).addClass("selected");
                        }).click(function() {
                           selectOption();
                        });
               })
            }


            /* collapsible helper */
            var coll = document.getElementsByClassName("collapsible");
            var i;

            for (i = 0; i < coll.length; i++) {
            coll[i].addEventListener("click", function() {
               this.classList.toggle("active");
               var content = this.nextElementSibling;
               if (content.style.display === "block") {
                  content.style.display = "none";
               } else {
                  content.style.display = "block";
               }
            });
            }


            /* when user scroll on page, scroll on link div */
            $(document).bind('mousewheel', function(e){
               if(e.originalEvent.wheelDelta /120 > 0) {
                     $('#item_container').scrollTop($('#item_container').scrollTop() - 30);
               } else {
                     $('#item_container').scrollTop($('#item_container').scrollTop() +30);
               }
            });


            /* on inactivity set the focus */
            function setIdleTimeout(millis, onIdle, onUnidle) {
               var timeout = 0;
               startTimer();

               function startTimer() {
                  timeout = setTimeout(onExpires, millis);
                  document.addEventListener("mousemove", onActivity);
                  document.addEventListener("keypress", onActivity);
               }
               
               function onExpires() {
                  timeout = 0;
                  onIdle();
               }

               function onActivity() {
                  if (timeout) clearTimeout(timeout);
                  //else onUnidle();
                  //since the mouse is moving, we turn off our event hooks for 1 second
                  document.removeEventListener("mousemove", onActivity);
                  document.removeEventListener("keypress", onActivity);
                  setTimeout(startTimer, 1000);
               }
            }

            setIdleTimeout(1000, function() {
               lastActions();
            }, null );

         </script>




<div id="loading">
   <img id="loading-image" src="assets/loader.gif" alt="Loading..." />
 </div>
</body>
<script src="js/periodic.js"></script>
<script src="js/WMOcodes.js"></script>
<script>

let conf_path = "data/conf.js";
try {
      $.getScript(conf_path, function() {
            //only if I have conf data:
            $.getScript("js/meteo.js", function() {});   
            $.getScript("js/welcome.js", function() {});   
            $.getScript("js/clock.js", function() {});   
      }).fail(function(){
               // if not found
               console.log("missing /data/conf.js");
               alert("missing /data/conf.js , please use /data/conf-dist.json to create your own")
      });
} catch (error) {

}

      /* when load is complete */
   $(window).ready(function() {
         let delay = 0;

         // on small screen wait for regulation
         var width = (window.innerWidth > 0) ? window.innerWidth : screen.width;
         if(width<=1024) {
            delay = 1000;
         }
         setTimeout(() => {  
            $('#loading').hide();
            $("#autofill").focus();
         }, delay);

   });
</script>
</html>